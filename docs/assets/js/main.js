"use strict";let series=[];const searchBtn=document.querySelector(".js-search-button"),searchBarBtn=document.querySelector(".js-searchbar-button"),searchInput=document.querySelector(".js-search-input"),mainSeriesContainer=document.querySelector(".js-series-main");let favorites=[];const favoritesSeriesContainer=document.querySelector(".js-series-favorites"),resetButton=document.querySelector(".js-reset-button");function searchSeries(){const e=searchInput.value;fetch("//api.tvmaze.com/search/shows?q="+e).then(e=>e.json()).then(e=>{series=e,ensureData()})}function getHtmlCode(e,t){let s="";for(const i of e){s+='<li class= "series_container-main">',s+=void 0===favorites.find(e=>e.show.id===i.show.id)?`<section class="series_container js-series-card" id= ${i.show.id}>`:`<section class="series_container js-series-card favorite" id= ${i.show.id}>`,null===i.show.image?s+='  <img src="https://via.placeholder.com/210x295/ffffff/666666/?text=TV" alt="" class="series_container--img" />':s+=`  <img src="${i.show.image.medium}" alt="" class="series_container--img" />`,s+=`  <h2 class="series_container--title">${i.show.name}</h2>`,s+="</section>",!0===t&&(s+='  <i class="far fa-times-circle series_container--x js-x"></i>'),s+="</li>"}return s}function paintSeries(){let e=getHtmlCode(series);mainSeriesContainer.innerHTML=e,addListeners()}function handleSearchClick(e){e.preventDefault(),searchSeries()}function showBar(e){const t=e.target.closest("form");t.classList.toggle("show"),t.classList.toggle("form")}function addListeners(){const e=document.querySelectorAll(".js-series-card");for(const t of e)t.addEventListener("click",handleFavoriteClick)}function handleFavoriteClick(e){const t=e.currentTarget,s=parseInt(t.id),i=series.find(e=>e.show.id===s);void 0===favorites.find(e=>e.show.id===i.show.id)?favorites.push(i):favorites=favorites.filter(e=>e.show.id!==s),ensureData()}function paintFavoritesSeries(){let e=getHtmlCode(favorites,!0);favoritesSeriesContainer.innerHTML=e,addDeleteListeners()}function setData(e,t){localStorage.setItem(e,JSON.stringify(t))}function getData(e){localStorage.getItem(e)&&(favorites=JSON.parse(localStorage.getItem(e)))}function handleReset(){favorites=[],ensureData()}function handleDeleteButton(e){const t=e.target.closest("li"),s=parseInt(t.id),i=favorites.find(e=>e.show.id===s);let r=favorites.indexOf(i);favorites.splice(r,1),ensureData()}function addDeleteListeners(){const e=document.querySelectorAll(".js-x");for(const t of e)t.addEventListener("click",handleDeleteButton)}function ensureData(){setData("favoritesLocal",favorites),paintFavoritesSeries(),paintSeries()}searchSeries(),searchBarBtn.addEventListener("click",handleSearchClick),searchBtn.addEventListener("click",showBar),resetButton.addEventListener("click",handleReset),getData("favoritesLocal"),ensureData();